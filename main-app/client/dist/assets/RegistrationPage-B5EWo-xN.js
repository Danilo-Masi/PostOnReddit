import{e as w,aK as v,r as t,j as e,B as S,aL as z,aY as P,aH as g}from"./index-BzlldT3p.js";import{C as R,b as U,d as A,e as F,f as H,L as p,I as f,g as M,a as T,h as D}from"./card-DMPIZq0x.js";import{M as K,L as q,E as $,a as B,A as V}from"./AuthHero-DEx-CxWP.js";import"./clock-sv1KeDJs.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=w("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=w("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),W="https://postonredditserver.vercel.app";function Y(){const l=v(),[i,d]=t.useState(""),[o,u]=t.useState(""),[r,h]=t.useState(""),[n,y]=t.useState(!1),[m,N]=t.useState(!1),b=async()=>{y(!0);const s=C(i,o,r);if(s.length<=0)try{const a=await T.post(`${W}/auth/registration`,{name:i,email:o,password:r},{headers:{"Content-Type":"application/json"}});if(a.status===400){k("Invalid credentials",a.status);return}a.status===200&&I(a.data.token)}catch(a){console.error("CLIENT: Errore generico del server",a.stack),k("Server error. Please try again later",a.status)}finally{y(!1)}else s.map(a=>{g.warning(a)})},C=(s,a,j)=>{const c=[],E=/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/,L=/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{6,}$/;return s.trim()||c.push("Username can't be empty"),a.trim()?E.test(a)||c.push("Email is not valid"):c.push("Email can't be empty"),j.length<6?c.push("Password must be at least 6 characters"):L.test(j)||c.push("Password must contain at least one letter, one number, and one special character"),c},k=(s,a)=>{console.error(`CLIENT: Error status: ${a}`),g.warning(s),d(""),u(""),h("")},I=s=>{localStorage.setItem("authToken",s),g.success("Registration successful"),l("/")},x=s=>{s.key==="Enter"&&b()};return e.jsxs(R,{className:"w-[90%] md:w-[400px] bg-zinc-50 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800 shadow-lg",children:[e.jsxs(U,{className:"space-y-1 pb-4",children:[e.jsx(A,{className:"text-2xl font-bold text-center",children:"Create an account"}),e.jsx(F,{className:"text-center text-zinc-500 dark:text-zinc-400",children:"Sign up to get started with postonreddit"})]}),e.jsxs(H,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"usernameInputId",className:"text-zinc-700 dark:text-zinc-300",children:"Username"}),e.jsxs("div",{className:"relative",children:[e.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-zinc-500 dark:text-zinc-400 w-4 h-4"}),e.jsx(f,{"aria-label":"input-username-registration",id:"usernameInputId",type:"text",placeholder:"Choose a username",required:!0,value:i,onChange:s=>d(s.target.value),onKeyDown:x,className:"pl-10 bg-white dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700 focus:border-orange-500 dark:focus:border-orange-500"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"emailInputId",className:"text-zinc-700 dark:text-zinc-300",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-zinc-500 dark:text-zinc-400 w-4 h-4"}),e.jsx(f,{"aria-label":"input-email-registration",id:"emailInputId",type:"email",placeholder:"Enter your email",required:!0,value:o,onChange:s=>u(s.target.value),onKeyDown:x,className:"pl-10 bg-white dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700 focus:border-orange-500 dark:focus:border-orange-500"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(p,{htmlFor:"passwordInputId",className:"text-zinc-700 dark:text-zinc-300",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-zinc-500 dark:text-zinc-400 w-4 h-4"}),e.jsx(f,{"aria-label":"input-password-registration",id:"passwordInputId",type:m?"text":"password",placeholder:"••••••••",required:!0,value:r,onChange:s=>h(s.target.value),onKeyDown:x,className:"pl-10 bg-white dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700 focus:border-orange-500 dark:focus:border-orange-500"}),e.jsx("button",{type:"button",onClick:()=>N(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-zinc-500 dark:text-zinc-400 hover:text-orange-500 dark:hover:text-orange-500",children:m?e.jsx($,{className:"w-4 h-4"}):e.jsx(B,{className:"w-4 h-4"})})]})]})]}),e.jsxs(M,{className:"flex flex-col space-y-4",children:[e.jsx(S,{"aria-label":"button-registration",type:"submit",className:"w-full bg-orange-500 hover:bg-orange-600 text-white",onClick:b,disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating account..."]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"mr-2 h-4 w-4"}),"Create account"]})}),e.jsxs("div",{className:"text-center text-sm text-zinc-600 dark:text-zinc-400",children:["Already have an account?"," ",e.jsx(P,{to:"/login",className:"font-medium text-orange-500 hover:text-orange-600 transition-colors",children:"Sign in"})]})]})]})}const Z=t.memo(V);function ee(){const l=v(),[i,d]=t.useState(!0),[o,u]=t.useState(!1);return t.useEffect(()=>{let r=!0;return(async()=>{try{const n=await D();r&&(u(!!n),n&&l("/"))}catch(n){console.error("Authentication check failed:",n)}finally{r&&d(!1)}})(),()=>{r=!1}},[l]),i?e.jsx("div",{className:"w-screen h-svh flex items-center justify-center bg-zinc-100 dark:bg-zinc-800",children:e.jsx(z,{className:"h-8 w-8 animate-spin text-orange-500"})}):o?null:e.jsxs("div",{className:"w-screen h-svh flex flex-col md:flex-row bg-zinc-100 dark:bg-zinc-800",children:[e.jsx("div",{className:"w-screen md:w-1/2 h-svh flex flex-col items-center justify-center",children:e.jsx(Y,{})}),e.jsx(Z,{})]})}export{ee as default};
