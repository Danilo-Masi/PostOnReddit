import{c as L,aK as w,r,j as e,B as I,aL as y,aY as E,aH as x}from"./index-DEBQ0z8W.js";import{C,b as S,d as P,e as A,f as F,L as f,I as b,g as R,a as T,h as D}from"./card-HYLlTUgW.js";import{M,L as H,E as K,a as $,A as U}from"./AuthHero-CG5lRh5s.js";import"./clock-FYd9ZoxO.js";/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=L("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),B="https://postonredditserver.vercel.app";function V(){const l=w(),[o,d]=r.useState(""),[i,u]=r.useState(""),[n,h]=r.useState(!1),[t,j]=r.useState(!1),g=async()=>{const a=k(o,i);if(a.length<=0){h(!0);try{const s=await T.post(`${B}/auth/login`,{email:o,password:i},{headers:{"Content-Type":"application/json"}});if(s.status===400){m("Invalid credentials",s.status);return}if(s.status===401){m("Login failed. Please try again later",s.status);return}s.status===200&&v(s.data.token)}catch(s){console.error("CLIENT: Errore generico del server",s.stack),m("Server error. Please try again later",s.status)}finally{h(!1)}}else a.map(s=>{x.warning(s)})},k=(a,s)=>{const c=[],N=/^[^\s@]+@[^\s@]+\.[^\s@]{2,}$/,z=/^(?=.*[A-Za-z])(?=.*\d)(?=.*[\W_]).{6,}$/;return a.trim()?N.test(a)||c.push("Email is not valid"):c.push("Email can't be empty"),s.length<6?c.push("Password must be at least 6 characters"):z.test(s)||c.push("Password must contain at least one letter, one number, and one special character"),c},m=(a,s)=>{console.error(`CLIENT: Error status: ${s}`),x.warning(a),d(""),u("")},v=a=>{localStorage.setItem("authToken",a),x.success("Access successful"),l("/")},p=a=>{a.key==="Enter"&&g()};return e.jsxs(C,{className:"w-[90%] md:w-[400px] bg-zinc-50 dark:bg-zinc-900 border-zinc-200 dark:border-zinc-800 shadow-lg",children:[e.jsxs(S,{className:"space-y-1 pb-4",children:[e.jsx(P,{className:"text-2xl font-bold text-center",children:"Welcome back!"}),e.jsx(A,{className:"text-center text-zinc-500 dark:text-zinc-400",children:"Sign in to your account to continue"})]}),e.jsxs(F,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"emailInputId",className:"text-zinc-700 dark:text-zinc-300",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(M,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-zinc-500 dark:text-zinc-400 w-4 h-4"}),e.jsx(b,{"aria-label":"input-email-login",id:"emailInputId",type:"email",placeholder:"Enter your email",required:!0,value:o,onChange:a=>d(a.target.value),onKeyDown:p,className:"pl-10 bg-white dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700 focus:border-orange-500 dark:focus:border-orange-500"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(f,{htmlFor:"passwordInputId",className:"text-zinc-700 dark:text-zinc-300",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-zinc-500 dark:text-zinc-400 w-4 h-4"}),e.jsx(b,{"aria-label":"input-password-login",id:"passwordInputId",type:t?"text":"password",placeholder:"••••••••",required:!0,value:i,onChange:a=>u(a.target.value),onKeyDown:p,className:"pl-10 bg-white dark:bg-zinc-800 border-zinc-300 dark:border-zinc-700 focus:border-orange-500 dark:focus:border-orange-500"}),e.jsx("button",{type:"button",onClick:()=>j(!t),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-zinc-500 dark:text-zinc-400 hover:text-orange-500 dark:hover:text-orange-500",children:t?e.jsx(K,{className:"w-4 h-4"}):e.jsx($,{className:"w-4 h-4"})})]})]})]}),e.jsxs(R,{className:"flex flex-col space-y-4",children:[e.jsx(I,{"aria-label":"button-login",type:"submit",className:"w-full bg-orange-500 hover:bg-orange-600 text-white",onClick:g,disabled:n,children:n?e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"mr-2 h-4 w-4"}),"Sign in"]})}),e.jsxs("div",{className:"text-center text-sm text-zinc-600 dark:text-zinc-400",children:["Don't have an account?"," ",e.jsx(E,{to:"/registration",className:"font-medium text-orange-500 hover:text-orange-600 transition-colors",children:"Sign up"})]})]})]})}const W=r.memo(U);function G(){const l=w(),[o,d]=r.useState(!0),[i,u]=r.useState(!1);return r.useEffect(()=>{let n=!0;return(async()=>{try{const t=await D();n&&(u(!!t),t&&l("/"))}catch(t){console.error("Authentication check failed:",t)}finally{n&&d(!1)}})(),()=>{n=!1}},[l]),o?e.jsx("div",{className:"w-screen h-svh flex items-center justify-center bg-zinc-100 dark:bg-zinc-800",children:e.jsx(y,{className:"h-8 w-8 animate-spin text-orange-500"})}):i?null:e.jsxs("div",{className:"w-screen h-auto md:h-svh flex flex-col md:flex-row bg-zinc-100 dark:bg-zinc-800",children:[e.jsx("div",{className:"w-screen md:w-1/2 h-svh flex flex-col items-center justify-center",children:e.jsx(V,{})}),e.jsx(W,{})]})}export{G as default};
